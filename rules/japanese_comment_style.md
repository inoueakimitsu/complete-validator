---
applies_to: ["*.py", "*.md"]
---
# Japanese Comment Style Rules

プログラムのコメントおよび docstring に適用されるルールです。

## 体言止め禁止

見出し以外の体言止めの箇所は、体言止めを使わず「～です。」「～します。」のように文末を丁寧語にしてください。

**Bad:**
```python
# ～の場合
# ～のリスト。
# ～を取得
# ～の選択
```

**Good:**
```python
# ～の場合の処理です。
# ～のリストです。
# ～を取得します。
# ～の選択を行います。
```

ただし、簡潔に表現できるものを冗長にしないでください。

**Bad:**
```python
# A を指定します。  ← 元が単に "A" で十分な場合、冗長
```

**Good:**
```python
# A です。
```

## 丁寧語の使用

コメントや docstring は丁寧語で書いてください。「～をする」は「～をします。」のようにしてください。

**Bad:**
```python
# ～の選択を行う
```

**Good:**
```python
# ～の選択を行います。
```

## docstring 必須

すべての関数、クラス、メソッド (private を含む) に docstring を記述してください。引数がある場合は Parameters セクション、戻り値がある場合は Returns セクションも記述してください。

**Bad:**
```python
def calculate_total(prices: list[float], tax_rate: float) -> float:
    return sum(prices) * (1 + tax_rate)


class DataProcessor:
    def process(self, data: list[str]) -> list[str]:
        return [d.strip() for d in data]
```

**Good:**
```python
def calculate_total(prices: list[float], tax_rate: float) -> float:
    """税込み合計金額を計算します。

    Parameters
    ----------
    prices: list[float]
        商品価格のリストです。
    tax_rate: float
        税率です。

    Returns
    -------
    float
        税込み合計金額です。
    """
    return sum(prices) * (1 + tax_rate)


class DataProcessor:
    """データの前処理を行うクラスです。"""

    def process(self, data: list[str]) -> list[str]:
        """文字列リストの前後の空白を除去します。

        Parameters
        ----------
        data: list[str]
            処理対象の文字列リストです。

        Returns
        -------
        list[str]
            空白を除去した文字列リストです。
        """
        return [d.strip() for d in data]
```

## NumPy 形式 docstring

docstring は NumPy 形式で書いてください。Parameters と Returns 内もスタイルを合わせてください。

**Bad:**
```python
def func(x):
    """処理を実行する。

    Args:
        x: 入力値
    """
```

**Good:**
```python
def func(x: int) -> str:
    """処理を実行します。

    Parameters
    ----------
    x: int
        入力値です。

    Returns
    -------
    str
        結果の文字列です。
    """
```

## コロンの日本語的使用

「です:」のようにコロンを英語のように使うのは避けて「です。」のように言い換えてください。

**Bad:**
```python
# ～は以下の通りです:
```

**Good:**
```python
# ～は以下の通りです。
```

**Bad:**
```python
# 例: "abc_class/1.0.0"
```

**Good:**
```python
# 例として "abc_class/1.0.0" のような文字列です。
```

## 半角と全角の間のスペース

半角文字の後、句読点を除く全角文字との間には半角スペースを入れてください。全角文字の後、句読点を除く半角文字との間にも半角スペースを入れてください。ただし句読点 (、。) の直前にはスペースを入れないでください。

**Bad:**
```python
# ABCを、DCEにし (FGH)それを～します。
```

**Good:**
```python
# ABC を、DCE にし (FGH) それを～します。
```

## 日本語文中のカンマ・コロン

日本語の文中では半角カンマ `,` ではなく読点 `、` を使用してください。括弧内の列挙も同様です。

**Bad:**
```python
# データ TSV, 測定 TSV, 修正 TXT, 検証 TSV から重要項目のリストを生成しファイルに保存します。
# 必要な列 (a, b, c) が存在することを確認します。
```

**Good:**
```python
# データ TSV、測定 TSV、修正 TXT、検証 TSV から重要項目のリストを生成しファイルに保存します。
# 必要な列 (a、b、c) が存在することを確認します。
```

## 全角カンマ後のスペース禁止

読点「、」の直後に半角スペースを入れないでください。

**Bad:**
```python
# xyz と相関の強い、 factor_candidate_list の要素を抽出します。
```

**Good:**
```python
# xyz と相関の強い、factor_candidate_list の要素を抽出します。
```

## docstring 内の型ヒント記法

docstring 内の型ヒントでは、変数名と `:` の間にスペースを入れないでください。`:` の後にはスペースを 1 つ入れてください。このルールは docstring 内の型ヒント記法にのみ適用し、通常のコード (スライス記法など) には適用しないでください。

**Bad:**
```python
"""
Parameters
----------
target_file : io.BytesIO
    対象ファイルです。
target_columns : list[str]
    対象カラムのリストです。
correct :str | None
    正解文字列です。
"""
```

**Good:**
```python
"""
Parameters
----------
target_file: io.BytesIO
    対象ファイルです。
target_columns: list[str]
    対象カラムのリストです。
correct: str | None
    正解文字列です。
"""
```

以下はこのルールの対象外です。修正しないでください。

```python
sentence[i : i + 512]  # スライス記法であり型ヒントではないため対象外
```

## カタカナ長音

カタカナ長音「ー」は以下のルールに従ってください。

1. 英語の -er、-or、-ar 接尾辞に由来するカタカナ語では「ー」を付けてください。それ以外の接尾辞 (-ry、-ty など) に由来するカタカナ語では「ー」を付けないでください。
2. カタカナ部分が 4 文字未満の語では「ー」を使用してください。
3. 文字数を数える際に「ッ」「ャ」「ュ」「ョ」「ァ」「ィ」「ゥ」は無視してください。
4. 複合語の場合、各部分を個別に評価してください。
5. 確立された例外 (カロリー、エネルギーなど) に従ってください。

**Bad:**
```python
# パラメータを調整します。
```

**Good:**
```python
# パラメーターを調整します。
```

**Bad:**
```python
# ユーティリティー関数です。
```

**Good:**
```python
# ユーティリティ関数です。
```

## カタカナ複合語のスペース

英語の複合語をカタカナにする場合、単語間に半角スペースを入れてください。ただし以下の例外があります。

- 「バー」の前にはスペースを入れてください。
- ハイフン付きの英語の単語 (例：ランタイム) にはスペースを入れないでください。
- 副詞とフレーズの組み合わせ (例：ログオン、チェックイン) にはスペースを入れないでください。

**Bad:**
```python
# データフレームを指定します。
# 対象のエントリポイントです。
# フォームデータを送信します。
```

**Good:**
```python
# データ フレームを指定します。
# 対象のエントリ ポイントです。
# フォーム データを送信します。
```

## 括弧の表記

日本語の文中で括弧を使う場合、全角括弧「（」「）」ではなく、半角スペース + 半角括弧 ` (` `)` を使用してください。閉じ括弧の後に句読点が続かない場合は半角スペースを入れてください。

**Bad:**
```python
# 対象ファイル（CSV 形式）を読み込みます。
# 入力値（必須）を検証します。
```

**Good:**
```python
# 対象ファイル (CSV 形式) を読み込みます。
# 入力値 (必須) を検証します。
```

## 通常英語表記する用語

通常英語で表記する用語を無理にカタカナ表記にしないでください。

**Bad:**
```python
# エラスティック アイ ピーを設定します。
```

**Good:**
```python
# Elastic IP を設定します。
```

## 中黒の禁止

列挙や並列表現に中黒「・」を使わないでください。読点「、」で区切ってください。

**Bad:**
```python
# 大阪・京都・兵庫の店舗データを集計します。
# CSV・TSV・JSON 形式に対応しています。
```

**Good:**
```python
# 大阪、京都、兵庫の店舗データを集計します。
# CSV、TSV、JSON 形式に対応しています。
```

## 括弧による注釈の後置禁止

文末に括弧で注釈・補足を後置しないでください。注釈の内容は文中に組み込むか、別のコメント行に分けてください。

**Bad:**
```python
# ファイルを読み込みます。(存在しない場合はエラーになります)
# 合計金額を計算します。(税込み)
# セグメントを送信します。(最大 300 秒)
```

**Good (文中に組み込む):**
```python
# 税込みの合計金額を計算します。
# 最大 300 秒のセグメントを送信します。
```

**Good (別行に分ける):**
```python
# ファイルを読み込みます。
# 存在しない場合はエラーになります。
```
